<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cantora+One&family=Noto+Sans:ital,wght@0,100..900;1,100..900&family=Zain:ital,wght@0,200;0,300;0,400;0,700;0,800;0,900;1,300;1,400&display=swap" rel="stylesheet">
    <link rel="icon" href="images/favicon.ico" type="image/x-icon">

    <title>Ian Stolte | Gameplay Programmer</title>
</head>

<body class="has-bg">

    <div id="header">
        <div id="title-wrapper" style="padding-bottom: 5px;">
            <span id="header-title"><a href="./index.html">Ian Stolte</a></span>
            <span id="header-subtitle">Gameplay Programmer</span>
        </div>
        <div id="right-header">
            <a href="https://ember44.itch.io"><img src="images/icons/Itch.png" alt="Itch.io Icon" class="header-icon-big" style="margin-bottom: -8px;"></a>
            <a href="https://github.com/Ian-Stolte"><img src="images/icons/GitHub.png" alt="GitHub Icon" style="margin-bottom: -7px;" class="header-icon-big"></a>
            <a href="https://www.linkedin.com/in/ianstolte/"><img src="images/icons/Linkedin.png" alt="Linkedin Icon" class="header-icon-big" style="margin-bottom: -7px;"></a>
            <a href="./resumé.pdf"><img src="images/icons/Resume.png" alt="Resumé Icon" class="header-icon-big"></a>
        </div>
        <div id="dropdown">
            <img src="images/icons/Hamburger.png" alt="Dropdown Icon" id="dropdown-top">
            <div id="dropdown-menu">
                <a href="./art.html">Art</a>
                <a href="https://ember44.itch.io">Itch.io</a>
                <a href="https://github.com/Ian-Stolte">GitHub</a>
                <a href="https://www.linkedin.com/in/ianstolte/">LinkedIn</a>
                <a href="./resumé.pdf">Resumé</a>
            </div>
        </div>
    </div>

    <div>
        <div class="game-page">
            <div style="clear: both;"></div>

            <div class="game-page-top">
                <video autoplay loop muted playsinline class="cover-gif">
                    <source src="/images/videos/VZero.mp4" type="video/mp4">
                </video>
                <div>
                    <h1>Version: Zero (2025)</h1>
                    <p class="game-summary">In this tactical sci-fi roguelike, forge your own powers from scratch—then adapt, upgrade,
                        and outsmart a digital world that resets with every death.</p>
                    
                    <div class="project-info">
                        <h2>Project Info</h2>
                        <a href="https://ember44.itch.io/version-zero"><p class="itch-button"><img src="images/icons/Itch.png" style="width: 40px; margin-right: 7px;">View on Itch.io</p></a>
                        <p class="itch-button-small"> <a href="https://ember44.itch.io/version-zero"><img src="images/icons/Itch.png" alt="Itch.io Icon" style="width: 40px;"></a> </p>
                        <p><b>Team Size</b>: 4</p>
                        <p><b>Role</b>: Director (all programming & design)</p>
                        <p><b>Project Length</b>: 6 months</p>
                        <p><b>Engine</b>: Unity</p>
                    </div>
                </div>
            </div>

            <div style="clear: both; padding: 10px 0px;"></div>

            <div class="desc">

                <!-- Key Contributions -->
                <h2 style="margin-bottom: 10px;">Key Contributions:</h2>

                <p style="margin: 20px 0px -5px 0px;"><i>Programming:</i></p>
                <button class="accordion-header" aria-expanded="false">Dialogue system with Google Sheets/JSON<span>+</span></button>
                <div class="accordion-panel">
                    <div>
                        <p>I created a custom <b>Google Sheets to JSON</b> pipeline to load the script for this game, allowing me to display the narrative in an easily readable format, edit
                            from any device, and easily collaborate with Sheets' multi-user editing.</p>
                        <video autoplay loop muted playsinline class="game-image-large">
                            <source src="/images/videos/VZero_Dialogue.mp4" type="video/mp4">
                        </video>
                        <p style="margin-top: 25px;">To make this pipeline quicker, I also wrote a basic editor tool, which allows me to specifiy which sheets I want to pull from, then
                            fetches the latest version of each sheet, converts to JSON, and places this result in the correct folder in the Unity project. In the end, it takes 5 clicks
                            to download, convert and organize the entire script!</p>
                        <video autoplay loop muted playsinline class="game-image-small">
                            <source src="/images/videos/VZero_DialogueDownload.mp4" type="video/mp4">
                        </video>
                        <p style="margin: 30px 0px 15px 0px;">This editor tool works by first sending a request to Google's <b>Apps Script</b>, where I wrote a simple program to export the sheet with the 1st row headers as keys.
                            It then clears the previous JSON files, creates a folder for each sheet in the Resources folder, and saves the JSON files there. On game start, I
                            load these JSON files using Resources.LoadAll() and parse them into C# dictionaries with <b>Newtonsoft.Json</b>.
                        </p>
                            <a href="https://github.com/Ian-Stolte/unity-resources/tree/main/Sheets-JSON%20Dialogue%20System" class="github-link">Code Snippets and Documentation</a>
                            <!--button class="accordion-header" id="small-accordion" aria-expanded="false">Code Snippet — Editor Tool<span>+</span></button>
                            <div class="accordion-panel">
                                <pre>
#if UNITY_EDITOR
public class JSONDownloader : EditorWindow
{
    private JSONConfig config;
    [MenuItem("Tools/Download Dialogue")]
    public static void ShowWindow()
    {
        GetWindow<JSONDownloader>("JSON Downloader");
    }

    private void OnEnable()
    {
        minSize = new Vector2(400, 300);
    }

    private void OnGUI()
    {
        GUILayout.Label("Google Sheets Downloader Settings", EditorStyles.boldLabel);

        var newConfig = (JSONConfig)EditorGUILayout.ObjectField("Config File",
        config, typeof(JSONConfig), false);
        if (newConfig != config)
        {
            config = newConfig;
        }
        if (GUILayout.Button("Download JSON Files"))
        {
            if (config != null)
            {
                DownloadJSONFiles();
            }
            else
            {
                Debug.LogError("Please assign a JSONConfig file.");
            }
        }
    }


    private void DownloadJSONFiles()
    {
        string urlTemplate = "https://script.google.com/macros/s/{0}/exec";
        foreach (var configEntry in config.dialogueConfigs)
        {
            string url = string.Format(urlTemplate, configEntry.sheetID, name);
            string jsonContent = DownloadFile(url);

            if (!string.IsNullOrEmpty(jsonContent))
            {
                string folderPath = "Assets/Resources/Dialogue";
                if (Directory.Exists(folderPath))
                    Directory.Delete(folderPath, true);
                
                Directory.CreateDirectory(folderPath);

                SaveSheetJSON(jsonContent, folderPath); 
            }
            else
            {
                Debug.LogError($"Failed to download the dialog file for {name}.");
            }
        }
    }

    private string DownloadFile(string url)
    {
        try
        {
            using (System.Net.WebClient client = new System.Net.WebClient())
            {
                return client.DownloadString(url);
            }
        }
        catch (System.Net.WebException ex)
        {
            Debug.LogError("Error downloading dialogue file: " + ex.Message);
            return null;
        }
    }

    private void SaveSheetJSON(string JSON, string folderPath)
    {
        try
        {
            JObject allSheets = JObject.Parse(JSON);
            foreach (var sheet in allSheets)
            {
                string filePath = Path.Combine(folderPath, sheet.Key + ".json");
                File.WriteAllText(filePath, sheet.Value.ToString());
                AssetDatabase.Refresh();
                Debug.Log($"Dialogue for {sheet.Key} saved to {filePath}
                successfully.");
            }
        }
        catch (System.Exception ex)
        {
            Debug.LogError("Error saving sheet JSON: " + ex.Message);
        }
    }
}
#endif
                                </pre>
                            </div>
                            <button class="accordion-header" id="small-accordion" aria-expanded="false">Code Snippet — JSON to Dictionary<span>+</span></button>
                            <div class="accordion-panel">
                                <pre>
private void LoadFromJson()
{
    TextAsset[] files = Resources.LoadAll<TextAsset>("Dialogue");
    foreach (TextAsset file in files)
    {
        var dict = ParseJsonToDictionary(file.text);
        foreach (var outerKey in dict.Keys)
        {
            var innerDict = dict[outerKey];
            var keysToUpdate = new List<string>(innerDict.Keys);
            foreach (var innerKey in keysToUpdate)
            {
                if (innerDict[innerKey] != null && innerDict[innerKey].Contains("--"))
                {
                    innerDict[innerKey] = innerDict[innerKey].Replace("--", "—");
                }
            }
        }
        dialogueBank.Add(dict);

        var counts = new Dictionary<string, int>();
        foreach (var key in dict.Keys)
        {
            counts[key] = 0;
        }
        SequenceManager.Instance.timesPlayed.Add(counts);
    }
}

private Dictionary<string, Dictionary<string, string>> ParseJsonToDictionary(string jsonString)
{
    try
    {
        var parsedData = JsonConvert.DeserializeObject<Dictionary<string, Dictionary<string, string>>>(jsonString);
        return parsedData;
    }
    catch (JsonException ex)
    {
        Debug.LogError("Error parsing JSON: " + ex.Message);
        return null;
    }
}
                                </pre>
                            </div>
                            <br id="small-accordion">-->
                    </div>
                </div>

                <button class="accordion-header" aria-expanded="false">Modular ability creation system<span>+</span></button>
                <div class="accordion-panel">
                    <div>
                        <p>One of the core mechanics of the game is an ability system where players create custom abilities using ~20 different ability components.</p>
                    </div>
                </div>

                <p style="margin: 20px 0px -5px 0px;"><i>Art:</i></p>
                <button class="accordion-header" aria-expanded="false">3D models, VFX, and shaders<span>+</span></button>
                <div class="accordion-panel">
                    <div>
                        <ul style="margin-top: 10px; margin-bottom: 10px;">
                            <li>A 3D model, rig, and walk animation for the <b>player character</b></li>
                            <li>3D models and a custom static shader for the <b>environment</b></li>
                            <li><b>VFX & shaders</b> for abilities and enemy attacks, using Unity's VFX Graph and Shader Graph</li>
                        </ul>
                        <i>(see the Art section on the homepage header for some examples!)</i>
                    </div>
                </div>
                
                <!-- Additional Content -->
                <!--<br>
                <hr>
                <h2>Additional Content</h2>
                <br>

                <img src="images/VZero Concept.png" alt="Early Concept" class="game-image-small">
                <p><i>Initial concept for the game</i></p>

                <video autoplay loop muted playsinline class="game-image-small">
                    <source src="/images/videos/VZero Draft 2.mp4" type="video/mp4">
                </video>
                <p><i>Early gameplay prototype</i></p>-->
                
                <br><br>
            </div>
        </div>
    </div>

    <script src="scripts/dropdown.js"></script>
    <script src="scripts/accordion.js"></script>
</body>

</html>